# TCP와 UDP 개념과 차이점을 정리해봅시다

오늘날 인터넷 통신의 대부분은 패킷 통신으로 이루어집니다. \*패킷 통신 규약 중 하나인 **TCP/IP**는 각각 전송 제어 프로토콜과 인터넷 프로토콜을 아울러 지칭하는 용어입니다.

<br/>

> 패킷(Packet): 패킷은 네트워크에서 전송되는 데이터의 기본 단위로, 작게 분할된 데이터 조각입니다. 용량이 큰 데이터를 그대로 보내게 되면, 그 데이터가 네트워크의 대역폭을 너무 많이 차지해서 다른 패킷의 흐름을 막을 위험이 있습니다. 그래서 데이터를 작은 조각으로 전송하고, 전송이 완료되면 이를 원래대로 다시 조립하는 작업이 필요합니다.

<br/>

**IP**(Internet Protocol)는 이러한 데이터 조각들을 정확한 목적지로 보내는 역할을 합니다. 그러나 그저 보내는 행위 자체에 집중하기 때문에, 패킷의 순서가 뒤바뀌거나 일부가 누락되는 등의 불안정한 단점들이 존재합니다.

여기서 `TCP`(Transmission Control Protocol)가 필요해집니다.

<br/>

## 1. TCP(Transmission Control Protocol)란 무엇인가요?

![tcp-ip](https://github.com/cona-tus/TIL/assets/90844424/f22e4a77-e0eb-423c-9b47-ca64f65c35b0)

**TCP**는 IP의 상위 프로토콜로서, 패킷 전송을 제어하여 안정성을 보장하는 프로토콜입니다. TCP에는 손실된 패킷, 순서가 잘못된 패킷, 중복된 패킷, 손상된 패킷 등의 문제를 해결하는 메커니즘이 포함되어 있습니다. TCP는 손상되거나 손실된 패킷이 있다면 재요청하고, 도착한 패킷들을 올바른 순서로 재조립합니다.

<br/>

### 1-1. TCP와 IP의 차이점은?

**IP**는 <u>패킷들이 가장 효율적인 방법으로 최종 목적지로 갈 수 있도록</u> 해주는 프로토콜이고, **TCP**는 신뢰성 있고 무결성을 보장하는 연결을 통해 <u>데이터를 안전하게 전송해주는 전송 프로토콜</u>입니다. 주로 이 둘을 함께 사용하여 인터넷 통신을 합니다.

<br/>
<br/>

## 2. TCP/IP 모델의 4계층

TCP/IP는 통신 프로세스를 4개의 개별 계층으로 나눕니다.

<br/>

### 2-1. 계층을 나누는 이유가 무엇인가요?

각 계층은 통신 프로세스의 서로 다른 부분을 담당하며 독립적입니다. 계층이 연결된 부분만 결정되어 있어, 자신이 담당하는 부분만 고려하면 되므로 설계가 편리합니다. 만약 사양이 변경된다면 특정 계층만 업데이트할 수 있음을 의미합니다.

<br/>

### 2-2. 4계층을 살펴봅시다

TCP/IP로 통신할 때 4계층을 순서대로 거쳐 상대와 통신 합니다.

![4layer](https://github.com/cona-tus/TIL/assets/90844424/6271ff19-0805-4de0-923f-07847875136e)

송신하는 측은 애플리케이션 계층에서부터 내려가며, 각 계층을 거칠 때마다 헤더에 필요한 정보가 추가됩니다. 반대로 수신하는 측은 네트워크 계층부터 위로 올라가며, 해당 계층마다 사용한 헤더를 삭제합니다. 이렇게 정보를 감싸는 것을 캡슐화라고 합니다.

<br/>

#### 애플리케이션 계층(Application Layer)

애플리케이션 계층은 TCP/IP 모델의 최상위 계층입니다. 이 계층에는 사용자가 일반적으로 상호작용하는 웹 브라우저, 이메일 클라이언트 등 데이터를 교환하는 모든 프로그램이 포함됩니다. 애플리케이션 계층의 역할은 단순히 데이터를 트랜스포트 계층으로 전송하는 것입니다.

<br/>

#### 트랜스포트 계층(Transport Layer)

트랜스포트 계층은 애플리케이션 계층에 네트워크로 접속되어 있는 두 장치 간에 안정적인 데이터 흐름을 제공합니다. 이 계층의 역할은 데이터를 패킷이라고 하는 더 작은 조각으로 나누는 것이며, 예로는 TCP와 UDP 두 가지 프로토콜이 있습니다.

<br/>

#### 네트워크 계층(Network or Internet Layer)

네트워크 계층은 네트워크 상에서 패킷의 이동을 다룹니다. 이 계층은 패킷이 어떠한 경로를 거쳐 특정 대상까지 전송되는지에 관심이 있습니다.

<br/>

#### 링크 계층(Data Link or Network Interface Layer)

링크 계층은 네트워크에 접속하는 하드웨어적인 면을 다룹니다. Wi-Fi, 이더넷 케이블, 네트워크 인터페이스 카드, 컴퓨터의 장치 드라이버 등을 사용하여 데이터를 보내고 받는 물리적 부분을 처리하는 계층입니다. 데이터가 통과하는 중앙 허브같은 것으로 생각할 수 있습니다.

<br/>

### 2-3. 이렇게 상상해볼까요?

당신은 아주 멋진 명화 퍼즐을 완성했습니다. 너무 멋져서 완성된 퍼즐을 우편을 통해 친구에게 보내려고 합니다. 당신이 퍼즐을 우체국으로 가져가면 이것이 **애플리케이션** 계층입니다.

우체국 직원은 퍼즐을 온전하게 보내는 것보다, 각 퍼즐 조각을 개별적으로 보내는 것이 더 쉽다고 결정합니다. 직원은 퍼즐을 분할하고, 그 작은 조각들을 포장합니다. 이것이 **트랜스포트** 계층입니다.

그리고 퍼즐 조각이 담긴 각 상자에 친구의 특정 주소를 적습니다. 이것이 **네트워크** 계층입니다.

다음으로, 다른 직원이 상자에 적힌 주소를 보고 배송을 위해 상자들을 트럭에 실습니다. 이 특정 트럭이 **링크** 계층입니다.

트럭이 상자들을 배달하면 친구는 최종 그림을 보기 위해 각 퍼즐 조각을 재조립하고, 완성된 명화를 보며 기뻐할 것입니다!

<br/>
<br/>

## 3. TCP의 특징을 알아봅시다

### 3-1. 연결 지향

TCP는 연결 지향 프로토콜로, 두 장치 간에 안정적인 연결을 설정합니다. 통신을 시작할 때는 3 Way, 통신을 마칠 때는 4 Way Handshake 과정을 거치게 됩니다.

<br/>

TCP/IP를 사용하여 패킷을 전송하는 과정을 단계별로 살펴봅시다.

#### 1단계: 연결 설정하기

![3-way](https://github.com/cona-tus/TIL/assets/90844424/c00b1d51-6af1-4cc3-91ea-42e424e15160)

1. 클라이언트는 서버에 연결 요청 메시지인 `SYN`(❔) 패킷을 보냅니다.
2. 서버는 클라이언트의 SYN 요청을 받으면, 클라이언트에게 연결 수락 응답 메시지인 `ACK`(👍) 패킷과 `SYN`(❔) 패킷을 보냅니다. 이 단계가 완료되면 클라이언트에서 서버로의 연결이 설정됩니다.
3. 클라이언트는 서버의 응답을 받고, 다시 서버에 연결 수락 확인 메시지인 `ACK`(👍) 패킷을 보냅니다. 이 후 서버와 클라이언트 간의 연결이 형성됩니다.

<br/>

Handshake를 완료하면, 실제 데이터가 포함된 패킷을 수신할 준비가 된 것입니다.

<br/>

#### 2단계: 데이터 패킷 보내기

1. 클라이언트는 데이터와 시퀀스 번호가 포함된 패킷을 보냅니다.
2. 서버는 `ACK`(👍)로 응답합니다.
3. 만약 클라이언트가 서버로부터 승인을 받지 못하면 제대로 송신하지 못한 것으로 판단하고 데이터를 재전송합니다.

<br/>

#### 3단계: 연결 종료하기

클라이언트와 서버가 더 이상 데이터를 주고 받지 않으려면 연결을 닫습니다.

1. TCP 연결이 되어있는 상태에서 클라이언트가 접속을 끊기 위해 `FIN`(✋) 패킷을 전송합니다.
2. 서버는 연결 종료 의사를 확인하고 수락 응답 메시지 `ACK`(👍)를 보냅니다. 이때 아직 보낼 데이터가 남아있는 경우, 데이터 전송이 완료될 때까지 잠시 대기합니다.
3. 데이터 전송이 완료되면, 서버는 `FIN`(✋) 요청 메시지를 보냅니다.
4. 클라이언트가 서버도 연결을 닫았다는 신호를 수신하면, `ACK`(👍)를 보냅니다.

모든 단계가 종료되면 연결이 닫힙니다.

<br/>

이러한 연결 방식의 장점은 메시지를 주고받으며 <u>데이터 전달을 보장</u>받을 수 있다는 것입니다.

<br/>
<br/>

### 3-2. 신뢰성 보장

TCP는 손실되거나 손상된 패킷을 감지하고, 순서가 잘못된 패킷을 처리하며, 중복 전송을 검사하고 복구하는 기능이 있습니다. 수신자는 상태를 확인하여 오류가 발생하면 송신자에게 전송을 다시 요청할 수 있습니다. 이로써 안정적인 데이터 전달과 신뢰성을 보장하게 됩니다.

<br/>
<br/>

## 4. UDP(User Datagram Protocol)란 무엇인가요?

`UDP`(User Datagram Protocol)는 사용자 데이터그램 프로토콜로, 데이터그램 방식을 사용하는 프로토콜입니다. 단순히 패킷을 주고 받기 때문에 데이터의 정확성 및 전달 순서를 보장하지는 않습니다. 다만, Handshake 과정이 필요하지 않아 전송 속도가 빠르다는 장점이 있습니다. TCP에 비해 신뢰성이 낮은 편이나, 개발자가 애플리케이션에서 구현을 어떻게 하느냐에 따라서 TCP와 비슷한 수준의 기능을 가질 수 있습니다.

<br/>

### 4-1. TCP와 UDP 비교하기

|                    | TCP                              | UDP                                         |
| ------------------ | -------------------------------- | ------------------------------------------- |
| 연결방식           | 연결지향                         | 비연결형 데이터그램 지향                    |
| 패킷 교환          | 가상 회선 방식                   | 데이터그램 방식                             |
| 전송 순서 보장     | 보장함                           | 보장하지 않음                               |
| 오류 검사 메커니즘 | 광범위한 오류 검사 메커니즘 제공 | 체크섬 사용으로 기본적인 오류 확인 메커니즘 |
| 신뢰성             | 높음                             | 낮음                                        |
| 전송속도           | 느림                             | 빠름                                        |
| 애플리케이션       | 이메일, 웹 서핑, 파일 전송 등    | 실시간 스트리밍, 비디오 등                  |

<br/>
<br/>

---

#### 참고

- [모든 개발자를 위한 HTTP 웹 기본 지식](https://inf.run/YWJd '김영한')
- [🌐 아직도 모호한 TCP / UDP 개념 ❓ 쉽게 이해하자](https://inpa.tistory.com/entry/NW-%F0%9F%8C%90-%EC%95%84%EC%A7%81%EB%8F%84-%EB%AA%A8%ED%98%B8%ED%95%9C-TCP-UDP-%EA%B0%9C%EB%85%90-%E2%9D%93-%EC%89%BD%EA%B2%8C-%EC%9D%B4%ED%95%B4%ED%95%98%EC%9E%90 '인파')
- [TCP/IP 3분 개념이해 (현업에 적용하는 CS 6탄)](https://youtu.be/BWOJc7K9Jw8?si=12YYHepRe5qnOIWI 'Code ON 코드온')
- [웹과 네트워크의 기본(TCP/IP)](https://velog.io/@conatuseus/2019-09-10-2009-작성됨-xsk0ds2eqf 'conatuseus')
- [What is TCP/IP and How Does it Work?](https://www.avast.com/c-what-is-tcp-ip 'Sharon Fisher')
- [TCP / IP Protocol: The 4 Layer Model](https://youtu.be/KEWe-5Bk3Q0?si=JpdHLqKAs9FEGBZT 'Lauren Dagworthy')
- [What is Transmission Control Protocol (TCP)?](https://www.geeksforgeeks.org/what-is-transmission-control-protocol-tcp/ 'jaygala260')
- [Transmission Control Protocol (TCP)](https://www.khanacademy.org/computing/computers-and-internet/xcae6f4a7ff015e7d:the-internet/xcae6f4a7ff015e7d:transporting-packets/a/transmission-control-protocol--tcp 'khan academy')
